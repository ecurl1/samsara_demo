<!DOCTYPE html>
<html lang="en">
<head>
    <head>
    <meta charset="UTF-8", http-equiv="refresh", content="3600">
    <title>Asset Returns</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
</head>
<body>
    <h1>Samsara Inegration Demo: Asset Time Series Plots</h1>
    
    <h2>Vehicle and Sensor Information</h2>
    <div class="header-info">
    {% for key, value in header_info.items() %}
        
        {% if value is mapping %}
            <div class="nested-group">
                <span class="header-info-outer-key-group">{{ key }}</span>
                
                {% for sub_key, sub_value in value.items() %}
                    
                    {% if sub_value is mapping %}
                        <div class="nested-sub-group">
                            <span class="header-info-inner-key-group">Sensor Type: {{ sub_key }}</span>
                            
                            {% for sub_sub_key, sub_sub_value in sub_value.items() %}
                                <div class="header-info-inner-item">
                                    <span class="header-info-key">{{ sub_sub_key }}:</span>
                                    <span class="header-info-value">{{ sub_sub_value }}</span>
                                </div>
                            {% endfor %}
                        </div> 
                        {% else %}
                        <div class="header-info-item">
                            <span class="header-info-key">{{ sub_key }}:</span>
                            <span class="header-info-value">{{ sub_value }}</span>
                        </div>
                    {% endif %}
                    
                {% endfor %}
            </div> 
            {% else %}
            <div class="header-info-item">
                <span class="header-info-key">{{ key }}:</span>
                <span class="header-info-value">{{ value }}</span>
            </div>
        {% endif %}
        
    {% endfor %}
    </div>

    <hr>

    <h2>Ambient Temperature Over Time (F)</h2>
    <div id="chart-container-temp", class="plot-container", style="width:100%; height:450px;"></div>

    <hr>
    <h2>Door State Over Time (0=Closed, 1=Open)</h2>
    <div id="chart-container-door", class="plot-container", style="width:100%; height:450px;"></div>

    <script>
        // get temperature plot data from Flask and plot
        var graphJsonTemp = JSON.parse('{{ plot_json_temp | safe }}');
        Plotly.newPlot('chart-container-temp', 
            graphJsonTemp.data, 
            graphJsonTemp.layout, 
            {responsive: true}
        );

        // get door state plot data from Flask and plot
        var graphJsonDoor = JSON.parse('{{ plot_json_door | safe }}');
        Plotly.newPlot('chart-container-door', 
            graphJsonDoor.data, 
            graphJsonDoor.layout, 
            {responsive: true}
        );
        
    </script>
</body>
</html>